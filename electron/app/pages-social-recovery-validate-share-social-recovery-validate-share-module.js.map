{"version":3,"sources":["./src/app/pages/social-recovery-validate-share/social-recovery-validate-share.module.ts","./src/app/pages/social-recovery-validate-share/social-recovery-validate-share.page.ts","./src/app/pages/social-recovery-validate-share/social-recovery-validate-share.page.html"],"names":[],"mappings":"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","file":"pages-social-recovery-validate-share-social-recovery-validate-share-module.js","sourcesContent":["import { CommonModule } from '@angular/common'\nimport { NgModule } from '@angular/core'\nimport { FormsModule } from '@angular/forms'\nimport { RouterModule, Routes } from '@angular/router'\nimport { IonicModule } from '@ionic/angular'\nimport { TranslateModule } from '@ngx-translate/core'\n\nimport { ComponentsModule } from '../../components/components.module'\n\nimport { SocialRecoveryValidateSharePage } from './social-recovery-validate-share.page'\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: SocialRecoveryValidateSharePage\n  }\n]\n\n@NgModule({\n  imports: [CommonModule, ComponentsModule, FormsModule, IonicModule, RouterModule.forChild(routes), TranslateModule],\n  declarations: [SocialRecoveryValidateSharePage]\n})\nexport class SocialRecoveryValidateSharePageModule {}\n","import { Component, ViewChild } from '@angular/core'\n\nimport { VerifyKeyComponent } from '../../components/verify-key/verify-key.component'\nimport { Secret } from '../../models/secret'\nimport { DeviceService } from '../../services/device/device.service'\nimport { ErrorCategory, handleErrorLocal } from '../../services/error-handler/error-handler.service'\nimport { NavigationService } from '../../services/navigation/navigation.service'\nimport { SecretsService } from '../../services/secrets/secrets.service'\n\n@Component({\n  selector: 'airgap-social-recovery-validate-share',\n  templateUrl: './social-recovery-validate-share.page.html',\n  styleUrls: ['./social-recovery-validate-share.page.scss']\n})\nexport class SocialRecoveryValidateSharePage {\n  @ViewChild('verify')\n  public verify: VerifyKeyComponent\n\n  public validated: boolean = false\n  public shares: string[]\n  public currentShare: number\n  public secret: Secret\n\n  constructor(\n    private readonly deviceService: DeviceService,\n    private readonly navigationService: NavigationService,\n    private readonly secretsService: SecretsService\n  ) {\n    this.shares = this.navigationService.getState().shares\n    this.secret = this.navigationService.getState().secret\n    this.currentShare = this.navigationService.getState().currentShare\n  }\n\n  public ionViewDidEnter(): void {\n    this.deviceService.enableScreenshotProtection({ routeBack: 'social-recovery-setup' })\n  }\n\n  public ionViewWillLeave(): void {\n    this.deviceService.disableScreenshotProtection()\n  }\n\n  public onComplete(isCorrect: boolean) {\n    this.validated = isCorrect\n  }\n\n  public onContinue() {\n    this.next.bind(this)()\n  }\n\n  public back() {\n    this.navigationService.back()\n  }\n\n  public next() {\n    if (this.shares.length === this.currentShare + 1) {\n      this.secret.hasSocialRecovery = true\n      this.secretsService\n        .addOrUpdateSecret(this.secret)\n        .then(() => {\n          // TODO: Route back to secret detail page\n          this.navigationService.route('/tabs/tab-settings').catch(handleErrorLocal(ErrorCategory.IONIC_NAVIGATION))\n        })\n        .catch(handleErrorLocal(ErrorCategory.SECURE_STORAGE))\n    } else {\n      this.navigationService\n        .routeWithState('/social-recovery-show-share', { shares: this.shares, currentShare: this.currentShare + 1, secret: this.secret })\n        .catch(handleErrorLocal(ErrorCategory.IONIC_NAVIGATION))\n    }\n  }\n}\n","<ion-header no-border>\n  <ion-toolbar>\n    <ion-title>\n      {{ 'social-recovery-validate-share.title' | translate }}\n    </ion-title>\n  </ion-toolbar>\n</ion-header>\n\n<ion-content>\n  <p class=\"ion-padding-horizontal\">{{ 'social-recovery-validate-share.text' | translate }}</p>\n  <airgap-verify-key\n    *ngIf=\"shares\"\n    #verify\n    [secret]=\"shares[currentShare]\"\n    (onComplete)=\"onComplete($event)\"\n    (onContinue)=\"onContinue()\"\n  ></airgap-verify-key>\n</ion-content>\n\n<ion-footer no-border color=\"primary\">\n  <airgap-progress-footer\n    [rightEnabled]=\"validated\"\n    [progress]=\"currentShare * 2 + 1\"\n    [maxProgress]=\"shares.length * 2\"\n    [rightAction]=\"next.bind(this)\"\n    [rightLabel]=\"shares.length - 1 === this.currentShare ? 'Finish' : 'Next'\"\n  ></airgap-progress-footer>\n</ion-footer>\n"],"sourceRoot":"webpack:///"}